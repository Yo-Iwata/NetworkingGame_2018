<!DOCTYPE html>
<html>
<head>
	<meta charset="utf8">
	<title>ブレイクハート</title>
	<style type="text/css">
		#canvas{
			border: 1px solid gray;
			width: 640px;
			height: 480px;
		}
	</style>
</head>
<body>

<!-- 通信結果をここに表示 -->
<canvas id="canvas"></canvas>

<a id="count">0</a>

<script>
//チョコを破壊したか?
var isbreak = false;
//カウントテキスト
var counttext = document.getElementById("count");
//クリックカウント変数
var clickCount = 0;
//canvasの取得
var canvas = document.getElementById("canvas");
//contextの取得
var context = canvas.getContext('2d');
//画像配列の生成
var imgs = new Array();
imgs[0] = new Image();
imgs[0].src = "asset/Images/choko.jpg";
imgs[1] = new Image();
imgs[1].src = "asset/Images/rip.jpg";
//
var width = imgs[0].width;
var height = imgs[0].height;
//表示する画像番号
var imgnum = 0;
//canvasに画像の表示
context.drawImage(imgs[imgnum],0,0,320,150);
//canvas内でクリックされたらカウントを増やす
canvas.onclick = function(e)
{
	//カウント増やす
	clickCount++;
	//現在のカウント数を表示
	counttext.innerHTML = clickCount;
	//20回クリックしたら
	if(clickCount >= 20)
	{
		//画像の表示番号を増やす
		imgnum = 1;
		//画像の表示
		context.drawImage(imgs[imgnum],0,0,320,150);
		//チョコを破壊した
		isbreak = true;
		//チョコの破壊を表示
		counttext.innerHTML = "チョコの破壊";
	}
	else
	{
		context.drawImage(imgs[imgnum],0,0,320,150);
	}
}
var hello  = document.querySelector("#getHello");
hello.addEventListener("click", function(){
	var request = new XMLHttpRequest();
	request.open('GET', 'http://localhost/hello.php', false);
	request.onload = function() {
		if (request.status === 200) {
			var response = request.responseText;
			var json     = JSON.parse(response);
			canvas.innerHTML = json.message;
		}
	};
	request.onerror = function() {
		//エラー時の処理
		canvas.innerHTML = "Error!";
	};
	//送信
	request.send();		//POSTの場合は引数に文字列を渡す
});
</script>
</body>
</html>
